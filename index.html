<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SUPER NEON JUMPER: LLAMA PRIME STRIKES BACK</title>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; }

    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      font-family: 'Courier New', monospace;
      color: #00ffcc;
      font-size: 20px;
      background: rgba(0,0,0,0.6);
      padding: 10px;
      border-radius: 8px;
    }

    #health-bar {
      width: 200px;
      height: 20px;
      background: red;
      border: 2px solid #fff;
      margin-top: 10px;
    }

    #health-fill {
      height: 100%;
      background: lime;
      width: 100%;
    }
  </style>
</head>
<body>
<div id="ui">
  <div>Score: <span id="score">0</span></div>
  <div id="health-bar"><div id="health-fill"></div></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.134/examples/js/controls/PointerLockControls.js"></script>
<script>
  let scene = new THREE.Scene();
  scene.background = new THREE.CubeTextureLoader().load([
    'https://threejs.org/examples/textures/cube/space/px.jpg',
    'https://threejs.org/examples/textures/cube/space/nx.jpg',
    'https://threejs.org/examples/textures/cube/space/py.jpg',
    'https://threejs.org/examples/textures/cube/space/ny.jpg',
    'https://threejs.org/examples/textures/cube/space/pz.jpg',
    'https://threejs.org/examples/textures/cube/space/nz.jpg',
  ]);

  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  const renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(5, 10, 7.5);
  scene.add(light);
  scene.add(new THREE.AmbientLight(0x404040));

  // === UI ===
  let score = 0;
  const scoreEl = document.getElementById('score');
  const healthFill = document.getElementById('health-fill');
  let health = 100;

  // === Player ===
  const playerGeometry = new THREE.BoxGeometry(1, 1, 1);
  const playerMaterial = new THREE.MeshStandardMaterial({ color: 0x00ffff });
  const player = new THREE.Mesh(playerGeometry, playerMaterial);
  player.position.set(0, 2, 0);
  scene.add(player);

  // === Ground ===
  const ground = new THREE.Mesh(
    new THREE.BoxGeometry(100, 1, 100),
    new THREE.MeshStandardMaterial({ color: 0x222222 })
  );
  ground.position.y = -0.5;
  scene.add(ground);

  // === Controls ===
  const keys = {};
  window.addEventListener('keydown', e => keys[e.key] = true);
  window.addEventListener('keyup', e => keys[e.key] = false);

  let velocityY = 0;
  let canJump = false;

  // === Platforms ===
  const platforms = [];
  function spawnPlatform(x, y, z, rotate = false) {
    const geo = new THREE.BoxGeometry(4, 0.5, 4);
    const mat = new THREE.MeshStandardMaterial({ color: 0x8888ff });
    const mesh = new THREE.Mesh(geo, mat);
    mesh.position.set(x, y, z);
    mesh.userData.rotate = rotate;
    scene.add(mesh);
    platforms.push(mesh);
  }

  spawnPlatform(5, 2, 0, true);
  spawnPlatform(10, 4, -2);
  spawnPlatform(15, 6, 2, true);
  spawnPlatform(20, 8, 0);

  // === Enemies ===
  const enemies = [];
  function spawnEnemy(x, y, z) {
    const geo = new THREE.SphereGeometry(0.5, 16, 16);
    const mat = new THREE.MeshStandardMaterial({ color: 0xff0000 });
    const enemy = new THREE.Mesh(geo, mat);
    enemy.position.set(x, y, z);
    enemy.userData.direction = 1;
    scene.add(enemy);
    enemies.push(enemy);
  }

  spawnEnemy(5, 2.5, 0);
  spawnEnemy(15, 6.5, 2);

  // === PowerUps ===
  const powerUps = [];
  function spawnPowerUp(x, y, z, type) {
    const geo = new THREE.IcosahedronGeometry(0.3);
    const mat = new THREE.MeshStandardMaterial({ color: type === 'speed' ? 0x00ff00 : 0xff00ff });
    const mesh = new THREE.Mesh(geo, mat);
    mesh.position.set(x, y, z);
    mesh.userData.type = type;
    scene.add(mesh);
    powerUps.push(mesh);
  }

  spawnPowerUp(10, 4.5, -2, 'speed');
  spawnPowerUp(18, 7.5, 2, 'jump');

  // === Game Loop ===
  let jumpPower = 0.2;
  let speed = 0.1;

  function animate() {
    requestAnimationFrame(animate);

    // === Movement ===
    if (keys['ArrowLeft']) player.position.x -= speed;
    if (keys['ArrowRight']) player.position.x += speed;
    if (keys['ArrowUp']) player.position.z -= speed;
    if (keys['ArrowDown']) player.position.z += speed;

    // === Gravity ===
    velocityY -= 0.01;
    player.position.y += velocityY;

    // === Platform Logic ===
    let onPlatform = false;
    [...platforms, ground].forEach(platform => {
      if (
        Math.abs(player.position.x - platform.position.x) < 2.5 &&
        Math.abs(player.position.z - platform.position.z) < 2.5 &&
        Math.abs(player.position.y - platform.position.y) < 1 &&
        velocityY <= 0
      ) {
        player.position.y = platform.position.y + 0.75;
        velocityY = 0;
        canJump = true;
        onPlatform = true;
      }

      // Rotate platform
      if (platform.userData.rotate) {
        platform.rotation.y += 0.01;
      }
    });
    if (!onPlatform) canJump = false;

    // === Jump ===
    if (keys[' '] && canJump) {
      velocityY = jumpPower;
      canJump = false;
    }

    // === Enemy Logic ===
    enemies.forEach(enemy => {
      enemy.position.x += 0.02 * enemy.userData.direction;
      if (enemy.position.x > 6 || enemy.position.x < 4) {
        enemy.userData.direction *= -1;
      }

      // Collision
      if (enemy.position.distanceTo(player.position) < 1) {
        health -= 1;
        healthFill.style.width = `${health}%`;
        if (health <= 0) {
          alert("LLAMA PRIME WINS. GAME OVER ðŸ’€");
          location.reload();
        }
      }
    });

    // === PowerUp Logic ===
    for (let i = 0; i < powerUps.length; i++) {
      const p = powerUps[i];
      if (p && player.position.distanceTo(p.position) < 1) {
        if (p.userData.type === 'speed') {
          speed = 0.2;
          setTimeout(() => speed = 0.1, 5000);
        } else if (p.userData.type === 'jump') {
          jumpPower = 0.35;
          setTimeout(() => jumpPower = 0.2, 5000);
        }
        score += 100;
        scoreEl.innerText = score;
        scene.remove(p);
        powerUps.splice(i, 1);
      }
    }

    // === Camera ===
    camera.position.x = player.position.x;
    camera.position.y = player.position.y + 5;
    camera.position.z = player.position.z + 10;
    camera.lookAt(player.position);

    renderer.render(scene, camera);
  }

  animate();
</script>
</body>
</html>

</script>
</body>
</html>
